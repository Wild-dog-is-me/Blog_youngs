---
title: 主题魔改
date: 2022-05-11 22:54:43
id: 20220511
author: 王建文
---

# 文章页面
## 删除other articles
原页面如下：
![article原页面](/static/img/202205/11-other-article原页面.png)
但是工作室认为并不需要此模块，需要对其进行去除。

找到主题文件下的`layout/post.ejs`文件，搜索`articles`，找到如下代码，添加两行代码：
```html
<!-- 添加的第一行代码 -->
<% if (theme.article.other) { %>
    <div class="row">
        <div class="col-lg-12">
            <!-- title -->
            <h5 class="trm-mb-40 trm-title-with-divider">
                <%- __('title.other_articles') %>
                <span data-number="02"></span>
            </h5>
        </div>
        <% if(page.prev){ %>
            <%- partial('./_partial/post-card',{ post: page.prev }) %>
        <%}%>
        <% if(page.next){ %>
            <%- partial('./_partial/post-card',{ post: page.next }) %>
        <%}%>
    </div>
<!-- 添加的第二行代码 -->
<% } %>
```
在主题的配置文件中，添加：
```yaml
article:
  other: false
```
如果`other`为`true`，则开启其他文章，若为`false`，则为不开启。
## 添加作者
在原主题中，博客的作者就是网站的作者，不可修改。但本博客是工作室运营，有区分作者的需求。
![article原页面](/static/img/202205/11-author.png)
找到主题文件下的`layout/post.ejs`文件，搜索`theme.user.name`，做出如下修改：
```html
<div class="trm-card trm-label trm-label-light text-center"><i class="far fa-user trm-icon"></i><br>
    <!-- 原来的代码 -->
    <!-- <%= theme.user.name %> -->
    <!-- 修改后的代码 -->
    <% if (!theme.article.author) { %>
    <%= theme.user.name %>
    <% } else { %>
    <%= page.author %>
    <% } %>
</div>
```
然后在文章的`markdown`文件里写`author`参数即可显示：
```markdown
---
title: 主题魔改
date: 2022-05-11 22:54:43
author: 王建文
---
```
在主题的配置文件中添加参数：
```yaml
article:
  author: true
```
当`author`为`true`时，作者使用博客内的`author`，当为`false`是使用的是整个项目的作者。

# 友链页面
## 展示效果
找到主题文件下的`layout/links.ejs`文件，搜索`site.title`，添加两行代码：
```html
<!-- 新加的第一行代码 -->
<% if (theme.banner.links.siteInformation) { %>
    <div class="row trm-mb-20">
        <div class="col-lg-12">
            <h5 class="trm-mb-40 trm-title-with-divider"><%- __('site.title') %><span
                        data-number="01"></span></h5>
        </div>
        <div class="col-lg-12">
            <div class="trm-service-icon-box trm-scroll-animation trm-active-el" data-scroll=""
                 data-scroll-offset="40">
                <ul class="trm-list">
                    <li><%- __('site.webmaster') %>：<%- theme.user.name %></li>
                    <li><%- __('site.domain') %>：<%- theme.user.domain %></li>
                    <li><%- __('site.avatar') %>：<%- theme.user.avatar %></li>
                    <li><%- __('site.describe') %>：<%- theme.user.describe %></li>
                </ul>
            </div>
        </div>
    </div>
<!-- 新加的第二行代码 -->
<% } %>
```
找到主题文件下的`layout/links.ejs`文件，搜索`title.links`，添加两行代码：
```html
<% if (theme.banner.links.siteInformation) { %>
    <div class="col-lg-12">
        <h5 class="trm-mb-40 trm-title-with-divider">
            <%- __('title.links') %>
            <span data-number="02"></span>
        </h5>
    </div>
<% } %>
```
在主题的配置文件中添加如下参数：
```yaml
banner: 
  links:
    siteInformation: false
```
当`siteInformation`为`false`时，即为关闭网站信息，`true`为开启。

## 友链书写位置
找到主题文件下的`layout/links.ejs`文件，搜索`theme.links.forEach`，做出如下修改：
```html
<!-- 原代码 -->
<% theme.links.forEach(item=>{ %>
<!-- 修改后的代码 -->
<% page.links.forEach(item=>{ %>
```
即可将友链的`yaml`列表从主题的`_config.yml`文件迁移到`source/links/index.md`中，书写方式和在`_config.yml`中相同，书写位置为`markdown`的头部位置，例如：
```markdowm
---
title: 友情链接
date: 2022-05-11 22:23:33
type: links
links:
- name: 白云苍狗 # 名称
  url: //www.imalun.com/ # 地址
  image: //www.imalun.com/images/avatar.jpg # 头像
  desc: 醒，亦在人间；梦，亦在人间 # 描述
---
```
这一改变可以让配置文件变得没有那么冗余，易于网站更新维护。

## 鼠标悬停Tooltip提示
还是在上一个位置，找到它的下一行，作如下修改：
```html
<% page.links.forEach(item=>{ %>
    <!-- 修改前 -->
    <!-- <div class="col-lg-6" data-toggle="tooltip" title='<%- item.author %>'> -->
    <!-- 修改后 -->
    <div class="col-lg-6" data-toggle="tooltip" title='<%- item.author %>'>
```
然后在`links`的`yml`中，添加`author`参数，如：
```yml
- name: 梦想已故
  url: https://dream.kwcoder.club/
  image: https://dream.kwcoder.club/images/icon.png
  desc: 当宇航员坠入大海，即是梦想逝去之时。
  author: 王建文
```



